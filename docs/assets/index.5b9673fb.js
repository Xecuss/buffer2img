import{S as N,i as D,s as H,e as g,a as L,b as u,c as v,d as y,f as w,g as b,l as C,n as U,r as K,t as T}from"./vendor.23053a67.js";const $=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))s(t);new MutationObserver(t=>{for(const r of t)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function l(t){const r={};return t.integrity&&(r.integrity=t.integrity),t.referrerpolicy&&(r.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?r.credentials="include":t.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(t){if(t.ep)return;t.ep=!0;const r=l(t);fetch(t.href,r)}};$();const z=async n=>{const e=new FileReader;return new Promise(l=>{e.readAsArrayBuffer(n),e.onload=s=>{l(s.target.result)}})},O=n=>{let e=new Blob([n]);return URL.createObjectURL(e)};let A=null;const B=()=>A||(A=document.createElement("canvas")),G=async n=>new Promise(e=>{n.toBlob(l=>{e(URL.createObjectURL(l))})});function S(n){let e,l;return{c(){e=g("img"),L(e.src,l=n[1])||u(e,"src",l),u(e,"alt","\u539F\u56FE"),u(e,"class","src-img svelte-63uibi")},m(s,t){v(s,e,t)},p(s,t){t&2&&!L(e.src,l=s[1])&&u(e,"src",l)},d(s){s&&y(e)}}}function q(n){let e,l,s,t,r,i;return{c(){e=g("div"),l=g("button"),l.textContent="\u7F16\u7801",s=w(),t=g("button"),t.textContent="\u89E3\u7801",u(l,"class","svelte-63uibi"),u(t,"class","svelte-63uibi"),u(e,"class","operate svelte-63uibi")},m(d,_){v(d,e,_),b(e,l),b(e,s),b(e,t),r||(i=[C(l,"click",n[6]),C(t,"click",n[4])],r=!0)},p:U,d(d){d&&y(e),r=!1,K(i)}}}function P(n){let e,l,s,t,r;return{c(){e=g("img"),s=w(),t=g("a"),r=T("\u4E0B\u8F7D\u56FE\u7247"),L(e.src,l=n[2])||u(e,"src",l),u(e,"alt","\u7ED3\u679C"),u(e,"class","src-img svelte-63uibi"),u(t,"href",n[2]),u(t,"download","")},m(i,d){v(i,e,d),v(i,s,d),v(i,t,d),b(t,r)},p(i,d){d&4&&!L(e.src,l=i[2])&&u(e,"src",l),d&4&&u(t,"href",i[2])},d(i){i&&y(e),i&&y(s),i&&y(t)}}}function J(n){let e,l,s,t,r,i,d,_,R,c=n[1]&&S(n),o=n[1]&&q(n),a=n[2]&&P(n);return{c(){e=g("main"),l=g("div"),s=g("input"),t=w(),c&&c.c(),r=w(),o&&o.c(),i=w(),d=g("div"),a&&a.c(),u(s,"type","file"),u(l,"class","left block svelte-63uibi"),u(d,"class","right block svelte-63uibi"),u(e,"id","main"),u(e,"class","svelte-63uibi")},m(f,m){v(f,e,m),b(e,l),b(l,s),b(l,t),c&&c.m(l,null),b(e,r),o&&o.m(e,null),b(e,i),b(e,d),a&&a.m(d,null),_||(R=C(s,"input",n[5]),_=!0)},p(f,[m]){f[1]?c?c.p(f,m):(c=S(f),c.c(),c.m(l,null)):c&&(c.d(1),c=null),f[1]?o?o.p(f,m):(o=q(f),o.c(),o.m(e,i)):o&&(o.d(1),o=null),f[2]?a?a.p(f,m):(a=P(f),a.c(),a.m(d,null)):a&&(a.d(1),a=null)},i:U,o:U,d(f){f&&y(e),c&&c.d(),o&&o.d(),a&&a.d(),_=!1,R()}}}function Q(n,e,l){let s,t="",r="";const i=async c=>{const o=B(),a=new Uint8Array(c),f=o.getContext("2d"),m=Math.floor(a.length/3)+1,h=Math.floor(Math.sqrt(m)),k=Math.round(Math.floor(m/h)+1);o.width=h,o.height=k,f.clearRect(0,0,h,k),console.log("start draw");for(let p=0;p<a.length;p+=3){let[j,E,F]=a.slice(p,p+3);const I=`rgb(${j}, ${E||0}, ${F||0})`,M=p/3;f.fillStyle=I,f.fillRect(M%h,Math.floor(M/h),1,1)}console.log("draw finished!"),l(2,r=await G(o))};return[s,t,r,i,()=>{const c=B(),o=c.getContext("2d"),{height:a,width:f}=c,{data:m}=o.getImageData(0,0,f,a),h=[];for(let p=0;p<m.length;p+=4){if(m[p+3]!==255){console.log("interupt!",p);break}h.push(...m.slice(p,p+3))}const k=Uint8Array.from(h);l(2,r=O(k.buffer))},async c=>{const o=c.currentTarget.files[0];l(0,s=await z(o)),l(1,t=O(s))},()=>i(s)]}class V extends N{constructor(e){super();D(this,e,Q,J,H,{})}}new V({target:document.getElementById("app")});
